# Enrichment Service Environment Variables
# Copy this file to .env and fill in your actual values

# ===================== Database Configuration =====================
MONGO_URI=mongodb://enrichment_user:changeMe123@mongodb:27017/gvpocr
MONGO_PASSWORD=changeMe123
DB_NAME=gvpocr

# ===================== Message Queue Configuration =====================
NSQD_HOST=nsqd
NSQD_PORT=4150
LOOKUPD_HTTP_ADDRESSES=nsqlookupd:4161
ENRICHMENT_TOPIC=enrichment
ENRICHMENT_CHANNEL=enrichment_worker
ENRICHMENT_BATCH_SIZE=50

# ===================== MCP Server Configuration =====================
MCP_ENABLED=true
MCP_SERVER_URL=ws://mcp-server:3000
MCP_JWT_SECRET=your_mcp_jwt_secret_key_here
MCP_AGENT_TOKEN=your_agent_token_here

# ===================== AI Model Configuration =====================

# Ollama Configuration (Local, Free)
OLLAMA_ENABLED=true
OLLAMA_HOST=http://ollama:11434
OLLAMA_MODEL=llama3.2
OLLAMA_FALLBACK_MODEL=mixtral
OLLAMA_TIMEOUT=120

# Claude API Configuration (Cloud, Paid)
ANTHROPIC_API_KEY=sk-ant-your-anthropic-api-key-here
CLAUDE_MODEL=claude-opus-4-5-20251101
CLAUDE_SONNET_MODEL=claude-sonnet-4-20250514
CLAUDE_HAIKU_MODEL=claude-haiku-4-20250514
CLAUDE_TIMEOUT=60

# ===================== Enrichment Configuration =====================

# Feature Flags
ENRICHMENT_ENABLED=true
ENABLE_PHASE1_PARALLEL=true
ENABLE_PHASE2_CONTENT=true
ENABLE_PHASE3_CONTEXT=true

# Quality Control
ENRICHMENT_REVIEW_THRESHOLD=0.95
ENRICHMENT_CONFIDENCE_THRESHOLD=0.70
MAX_MISSING_FIELDS_ALLOWED=5

# Cost Controls
MAX_COST_PER_DOC=0.50
DAILY_BUDGET_USD=100.00
MONTHLY_BUDGET_USD=2000.00
MAX_CLAUDE_TOKENS_PER_DOC=50000
COST_ALERT_THRESHOLD_USD=100.00

# Processing Controls
ENRICHMENT_TIMEOUT_SECONDS=300
MAX_RETRIES=3
RETRY_BACKOFF_MULTIPLIER=2
CONCURRENT_WORKERS=2
MAX_QUEUE_SIZE=500

# ===================== Logging Configuration =====================
LOG_LEVEL=INFO
LOG_FORMAT=json
LOG_FILE=/var/log/enrichment/enrichment.log
LOG_MAX_BYTES=10485760
LOG_BACKUP_COUNT=10

# ===================== Monitoring Configuration =====================

# Prometheus Metrics
METRICS_ENABLED=true
METRICS_PORT=8000
METRICS_INTERVAL=15

# Grafana Configuration
GRAFANA_ADMIN_USER=admin
GRAFANA_ADMIN_PASSWORD=admin123
GF_SECURITY_ADMIN_PASSWORD=admin123
GF_INSTALL_PLUGINS=grafana-clock-panel,grafana-simple-json-datasource

# ===================== Review Queue Configuration =====================
REVIEW_API_PORT=5001
REVIEW_API_HOST=0.0.0.0
REVIEW_API_DEBUG=false
REVIEW_API_WORKERS=4

# ===================== Cost API Configuration =====================
COST_API_PORT=5002
COST_API_HOST=0.0.0.0
COST_API_DEBUG=false
COST_API_WORKERS=4

# ===================== Integration Configuration =====================

# OCR Pipeline Integration
OCR_RESULT_COLLECTION=ocr_results
OCR_JOB_COLLECTION=ocr_jobs
ENRICHMENT_JOB_COLLECTION=enrichment_jobs
ENRICHED_DOCUMENT_COLLECTION=enriched_documents

# Archipelago Data Mapper
ARCHIPELAGO_ENABLED=true
ARCHIPELAGO_REPOSITORY_URL=http://archipelago-api:8000

# ===================== Schema Configuration =====================
SCHEMA_PATH=/app/enrichment_service/schema/historical_letters_schema.json
SCHEMA_VALIDATION_STRICT=false
AUTO_CORRECT_SCHEMA_ERRORS=true

# ===================== Security Configuration =====================
CORS_ENABLED=true
CORS_ORIGINS=http://localhost:3000,http://localhost:3001,http://localhost:5000
JWT_SECRET=your_jwt_secret_key_here
API_KEY=your_api_key_here

# ===================== Development Configuration =====================
ENVIRONMENT=production
FLASK_ENV=production
DEBUGPY_ENABLED=false
DEBUGPY_PORT=5678

# ===================== Vendor Configuration =====================

# Google Cloud Vision (Optional - for secondary OCR)
GOOGLE_APPLICATION_CREDENTIALS=/secrets/gcp_key.json
GOOGLE_VISION_ENABLED=false

# Azure Computer Vision (Optional - for secondary OCR)
AZURE_VISION_ENDPOINT=https://your-resource.cognitiveservices.azure.com/
AZURE_VISION_KEY=your-azure-key
AZURE_VISION_ENABLED=false

# ===================== Backup and Disaster Recovery =====================
BACKUP_ENABLED=false
BACKUP_FREQUENCY=daily
BACKUP_RETENTION_DAYS=30
BACKUP_DESTINATION=/backups/enrichment

# ===================== Advanced Configuration =====================

# Performance Tuning
BATCH_SIZE=50
CONNECTION_POOL_SIZE=20
QUEUE_TIMEOUT=30
ASYNC_WORKERS=4

# Feature Toggles
FEATURE_ENTITY_DISAMBIGUATION=true
FEATURE_HISTORICAL_CONTEXT=true
FEATURE_RELATIONSHIP_MAPPING=true
FEATURE_MULTILINGUAL_SUPPORT=true
FEATURE_ADVANCED_NER=true

# Experiment Flags
EXPERIMENT_NEW_PROMPT_STYLE=false
EXPERIMENT_TOKEN_OPTIMIZATION=false
EXPERIMENT_MODEL_ROUTING_V2=false
